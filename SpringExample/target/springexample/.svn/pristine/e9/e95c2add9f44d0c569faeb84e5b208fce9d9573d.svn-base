<%@ page language="java" contentType="text/html; charset=GBK"
    pageEncoding="GBK"%><%
//搜索布局
        StringBuffer searchBuf = new StringBuffer();
        ArrayList<BlackSearch> searchList = thisTable.getSearchList();
        HashMap<String,BlackColumn> bcMap = thisTable.getColumnMap();
        
        for(BlackSearch bs : searchList){
            String columnName = bs.getColumnName();
            BlackColumn thisColumn = bcMap.get(columnName);

            if(thisColumn==null)
                continue;
            
            if(thisColumn.getTypeName().equals("text")||thisColumn.getTypeName().equals("number")){
                searchBuf.append("{\n");
                searchBuf.append("xtype:'textfield',\n");
                searchBuf.append("width : "+thisColumn.getSize()+",\n");
                searchBuf.append("id : 'query_"+ thisColumn.getName() +"',\n");
                searchBuf.append("name : 'query_"+ thisColumn.getName() +"',\n");
                searchBuf.append("fieldLabel:'"+ thisColumn.getCnName() +"'\n");
                searchBuf.append("},\n");
                
            }else if(thisColumn.getTypeName().equals("select")){                
                
                searchBuf.append("{\n");
                searchBuf.append("xtype:'combo',\n");
                searchBuf.append("fieldLabel:'"+thisColumn.getCnName()+"',\n");
                searchBuf.append("name : 'query_"+ thisColumn.getName() +"',\n");
                searchBuf.append("id : 'query_"+ thisColumn.getName() +"',\n");
                searchBuf.append("allowBlank : false,\n");
                searchBuf.append("blankText : '"+thisColumn.getCnName()+"为必填项',\n");
                searchBuf.append("hiddenName : '"+ thisColumn.getName() +"',\n");
                
                searchBuf.append("store: Ext.exampledata.exampledata_"+ thisColumn.getName() +",\n");
                if(thisColumn.getDataSrc().isEmpty())
                    searchBuf.append("store: Ext.exampledata.exampledata_"+ thisColumn.getName() +",\n");
                else{
                    searchBuf.append("store: "+thisColumn.getName()+"SelectStore,\n");
                    searchBuf.append("displayField: '"+thisColumn.getItemText()+"',\n");
                    searchBuf.append("valueField: '"+thisColumn.getItemValue()+"',\n");
                }
                
                searchBuf.append("listWidth :'"+thisColumn.getSize()+"',\n");   
                
                searchBuf.append("typeAhead: true,\n"); 
                searchBuf.append("forceSelection: true,\n");    
                searchBuf.append("triggerAction: 'all',\n");    
                searchBuf.append("emptyText:'请选择其中一种...',\n");  
                searchBuf.append("selectOnFocus:true,\n");  
                searchBuf.append("value: '"+ thisColumn.getDefaultValue() +"'\n");  
                searchBuf.append("},\n");
                                                                                                
            }else if(thisColumn.getTypeName().equals("radio")){
                int i = 0;
                int itemsNum = thisColumn.getItems().size();
                searchBuf.append("{");
                searchBuf.append("xtype:'radiogroup',");
                searchBuf.append("layout:'column',");
                searchBuf.append("columns:"+itemsNum+",");
                searchBuf.append("width:620,");
                searchBuf.append("fieldLabel:'"+thisColumn.getCnName()+"',");
                searchBuf.append("autoHeight:true,");
                searchBuf.append("labelSeparator: ':',");
                searchBuf.append("items:[");
                for(BlackColumnItem bi : thisColumn.getItems()){
                    i++;
//                  searchBuf.append("{\n");
//                  searchBuf.append("xtype: 'radio',\n");
//                  if(i==1){
//                      searchBuf.append("fieldLabel: '"+thisColumn.getCnName()+":',\n");
//                  }else{
//                      searchBuf.append("fieldLabel: '',\n");
//                  }
//                      
//                  if(bi.getValue().equals(thisColumn.getDefaultValue()))
//                      searchBuf.append("checked: true,\n");
//                  else
//                      searchBuf.append("checked: false,\n");
//                      
//                  searchBuf.append("width: '"+thisColumn.getSize()+"',\n");   
//                  searchBuf.append("labelSeparator: '',\n");
//                  searchBuf.append("boxLabel: '"+ bi.getText() +"',\n");
//                  searchBuf.append("id: 'query_"+ thisColumn.getName()+ i +"',\n");                               
//                  searchBuf.append("name: 'query_"+ thisColumn.getName() +"',\n");
//                  searchBuf.append("inputValue: '"+ bi.getValue() +"'\n");
//                  searchBuf.append("},\n");   
                    searchBuf.append("{");
                    searchBuf.append("labelSeparator: '',");
                    searchBuf.append("width: 80,");
                    searchBuf.append("boxLabel:'"+bi.getText()+"',");
                    searchBuf.append("id: 'query_"+ thisColumn.getName()+ i +"',");                              
                    searchBuf.append("name: 'query_"+ thisColumn.getName() +"',");
                    searchBuf.append("inputValue: '"+ bi.getValue() +"',");
                     if(bi.getValue().equals(thisColumn.getDefaultValue()))
                         searchBuf.append("checked: true");
                     else
                         searchBuf.append("checked: false");
                    if(i==(itemsNum))
                        searchBuf.append("}");
                    else searchBuf.append("},");
                }
                searchBuf.append("]},\n");
            }else if(thisColumn.getTypeName().equals("datetime")){
                 searchBuf.append("{");
                 searchBuf.append("layout:'column',");
                 searchBuf.append("width : 620,");
                 searchBuf.append("border:false,");
                 if(thisTable.isSelfConfig()){
                     searchBuf.append("hidden:false,");
                 }else{
                     searchBuf.append("hidden:true,");
                 }
                 searchBuf.append("items:[{");
                 searchBuf.append("columnWidth:.5,");
                 searchBuf.append("layout: 'form',");
                 searchBuf.append("border:false,");
                 searchBuf.append("items: [{");
                 searchBuf.append("xtype:'textfield',");
                 searchBuf.append("id : 'query_"+thisColumn.getName()+"_start',");
                 searchBuf.append("name : 'query_"+thisColumn.getName()+"_start',");
                 searchBuf.append("fieldLabel:'"+thisColumn.getCnName()+"',");
                 searchBuf.append("cls:'Wdate'");
                 searchBuf.append("}]");
                 searchBuf.append("},{");                           
                 searchBuf.append("columnWidth:.5,");
                 searchBuf.append("layout: 'form',");
                 searchBuf.append("border:false,");
                 searchBuf.append("items: [{");
                 searchBuf.append("xtype:'textfield',");
                 searchBuf.append("id : 'query_"+thisColumn.getName()+"_end',");
                 searchBuf.append("name : 'query_"+thisColumn.getName()+"_end',");
                 searchBuf.append("fieldLabel:'到',");
                 searchBuf.append("cls:'Wdate'");
                 searchBuf.append("}]");
                 searchBuf.append("}");
                 searchBuf.append("]");
                 searchBuf.append("},");
            }
            
        }
        %>