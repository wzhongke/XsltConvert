<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="GBK"%>
<%@ page import="
java.util.HashMap,
java.util.ArrayList,
java.util.Iterator,
com.sohu.frontweb.base.data.Leaf,
com.sohu.frontweb.ubs.data.BlackTable,
com.sohu.frontweb.ubs.service.BlacklistService"%>   
  
<%!
/*****************生成menuList********************/
    private StringBuffer genMenuList(Leaf thisNode,boolean root){
        if(!thisNode.hasChild())
            return new StringBuffer();
        
        StringBuffer sb = new StringBuffer();
        
        if(root)
            sb.append("<ul class='menu'>\n");
        else
            sb.append("<ul>\n");
            
        Iterator it = thisNode.getChildList().iterator();
        while(it.hasNext()){
            Leaf leaf = (Leaf)it.next();
            sb.append("<li><a url='"+(leaf.getNodeValue()!=null?leaf.getNodeValue()+"'  onclick='loadMainContent(this)' ":"#'")+"  "+ (leaf.hasChild()?"class='parent'":"") +"  class='"+leaf.getNodeName()+"'  ><span>"+leaf.getNodeName()+"</span></a>");
            sb.append(genMenuList(leaf,false));
            sb.append("</li>");
        }
        sb.append("</ul>");
        return  sb;
    }

%> 
 
<%

/***************加载通用mysqldb数据*******************/
    
    HashMap<String,HashMap<String,ArrayList<Leaf>>> menuMap = new HashMap<String,HashMap<String,ArrayList<Leaf>>>();
    menuMap.put("web",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("pic",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("video",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("music",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("news",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("blog",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("tt",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("wap",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("all",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("shop",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("cooperation",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("apply",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("xiaochuizhi",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("wenwen",new HashMap<String,ArrayList<Leaf>>());
    menuMap.put("app",new HashMap<String,ArrayList<Leaf>>());
    /*
    //menuMap.put("web",new ArrayList<Leaf>());
    menuMap.put("pic",new ArrayList<Leaf>());
    menuMap.put("video",new ArrayList<Leaf>());
    menuMap.put("music",new ArrayList<Leaf>());
    menuMap.put("news",new ArrayList<Leaf>());
    menuMap.put("blog",new ArrayList<Leaf>());
    menuMap.put("tt",new ArrayList<Leaf>());
    menuMap.put("all",new ArrayList<Leaf>());
    menuMap.put("apply",new ArrayList<Leaf>());
    */
    
    java.util.Iterator it = BlacklistService.TABLE_MAP.entrySet().iterator();
    
    
    //二级目录
    boolean flag=false;
    while(it.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)it.next();
        BlackTable bt = (BlackTable)entry.getValue();
        
        if(bt.getName().indexOf("umis_")!=-1)
            continue;
        
        String[] tNameArr = bt.getName().replace("ubs_","").replace("black_","").replace("white_","").split("_");
        String product = tNameArr[0];
        String secCla = "其它";
        //out.println(product+":"+ bt.getName()+"\n");
        if(tNameArr.length>2){
            secCla = tNameArr[1];
            if(product.equals("all")&&secCla.equals("wap")){
                product ="wap";
                secCla = "其它";
            }
        }
        if(bt.getName().equals("ubs_web_spider_actlog"))continue;
        if(bt.getName().equals("ubs_white_web_spider_url"))continue;
        if(bt.getName().equals("ubs_white_all_antispider")){
                secCla = "antispider";
        }
        
        HashMap<String,ArrayList<Leaf>> secClaMap = menuMap.get(product);
        
        ArrayList<Leaf> itemList = null;
        if(secClaMap.containsKey(secCla))
            itemList = secClaMap.get(secCla);
        else
            itemList = new ArrayList<Leaf>();
        
        if(secCla.equals("vropen")&&!flag){
            itemList.add(new Leaf("数据开放平台","open.do?method=showRes",null));
            flag=true;
        }
        itemList.add(new Leaf(bt.getCnName(),"ubs.do?method=showBlacklist&table="+ bt.getName(),null));
        secClaMap.put(secCla,itemList);
        menuMap.put(product,secClaMap);
                
    }
    
    
/***************************************************/

//配置菜单项：


/*********网页************/

  ArrayList spiderList = new ArrayList(){{
  add(new Leaf("域名表黑名单","domain.do?method=showDomainList",null));
  add(new Leaf("前缀表黑名单","prefix.do?method=showPrefixList",null));
  add(new Leaf("url白名单","protect.do?method=showProtectList",null));
  add(new Leaf("spider操作日志","ubs.do?method=showBlacklist&table=ubs_web_spider_actlog",null));
  add(new Leaf("报警白名单","ubs.do?method=showBlacklist&table=ubs_white_web_spider_url",null));
  }};

  ArrayList hackList = new ArrayList(){{
      add(new Leaf("被黑域名表黑名单","hackdomain.do?method=showDomainList",null));
      add(new Leaf("被黑前缀表黑名单","hackprefix.do?method=showPrefixList",null));
      add(new Leaf("被黑保护白名单","hackprotect.do?method=showProtectList",null));
  }};
  
  ArrayList fwBlackList = new ArrayList(){{
  add(new Leaf("前台限制词黑名单","frontWebpage.do?method=showFrontWebpageList",null));
  add(new Leaf("限制词分类","frontWebpageGroup.do?method=showFrontWebpageGroupList",null));
  }};

  ArrayList queryList = new ArrayList(){{
  add(new Leaf("网页query黑名单","query_webpage.do?method=showRecordList",null));
  add(new Leaf("网页快照黑名单","snap.do?method=showRecordList",null));
  }};

  ArrayList vrList = new ArrayList(){{
  add(new Leaf("VR黑名单","vr_webpage.do?method=showRecordList",null));
  add(new Leaf("VR白名单","vr_white.do?method=showRecordList",null));
  add(new Leaf("VR数据验证","webUIS.do?method=showAladdinValidator",null));

  }};

  ArrayList secList = new ArrayList(){{
  add(new Leaf("IP黑名单","secadmin_blackip.do?method=showRecordList",null));
  add(new Leaf("URL黑名单","secadmin_blackurl.do?method=showRecordList",null));
  add(new Leaf("查询违禁词","secadmin_input.do?method=showRecordList",null));
  add(new Leaf("摘要违禁词","secadmin_output.do?method=showRecordList",null));
  add(new Leaf("URL前缀黑名单","secadmin_url_set.do?method=showRecordList",null));
  add(new Leaf("IP白名单","secadmin_whiteip.do?method=showRecordList",null));
  add(new Leaf("URL白名单","secadmin_whiteurl.do?method=showRecordList",null));
  }};
  
  


  ArrayList webList = new ArrayList();
  webList.add(new Leaf("Spider黑名单",null,spiderList));
  webList.add(new Leaf("hack黑名单",null,hackList));
  webList.add(new Leaf("前台限制词黑名单",null,fwBlackList));
  webList.add(new Leaf("Query黑名单",null,queryList));
  webList.add(new Leaf("hint黑名单","hint_webpage.do?method=showRecordList",null));
  webList.add(new Leaf("VR管理",null,vrList));
  webList.add(new Leaf("网页固排","webUIS.do?method=showWebFixrankList",null));
  webList.add(new Leaf("信产部黑名单",null,secList));
  webList.add(new Leaf("Anchor黑名单","anchor.do?method=showAnchorList",null));  
  //webList.add(new Leaf("数据开放平台","open.do?method=showRes",null));
  //webList.add(new Leaf("流量查询系统",null,flowList));
  
  java.util.Iterator webClaIt = menuMap.get("web").entrySet().iterator();   
    //二级目录
   while(webClaIt.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)webClaIt.next();
        webList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }
   /****新闻********/
   ArrayList<Leaf> newsList = new ArrayList<Leaf>();
   java.util.Iterator<?> newsClaIt = menuMap.get("news").entrySet().iterator();
           //二级目录
      while(newsClaIt.hasNext()){
                   java.util.Map.Entry<String,ArrayList<Leaf>> entry = (java.util.Map.Entry<String,ArrayList<Leaf>>)newsClaIt.next();
                   newsList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
     }
/*********图片************/
   ArrayList picList = new ArrayList();
   picList.add(new Leaf("图片固排",null,
    new ArrayList(){{
        add(new Leaf("预览模式","picUIS.do?method=showPreviewList",null));
        add(new Leaf("列表模式","picUIS.do?method=showRecordList",null));

    }}
   ));

  java.util.Iterator picClaIt = menuMap.get("pic").entrySet().iterator();   
    //二级目录
   while(picClaIt.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)picClaIt.next();
        picList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }

   
  // picList.add(new Leaf("其它", null,menuMap.get("pic")));
     
/*********视频************/
   ArrayList videoList = new ArrayList();
   videoList.add(new Leaf("视频固排",null,
    new ArrayList(){{
        add(new Leaf("预览模式","videoUIS.do?method=showPreviewList",null));
        add(new Leaf("列表模式","videoUIS.do?method=showRecordList",null));

    }}
   ));

  java.util.Iterator videoClaIt = menuMap.get("video").entrySet().iterator();   
   while(videoClaIt.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)videoClaIt.next();
        videoList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }   
  //videoList.add(new Leaf("其它", null,menuMap.get("video")));

  ArrayList menuList = new ArrayList();
  menuList.add(new Leaf("网页",null,webList));
  menuList.add(new Leaf("图片",null,picList));
  menuList.add(new Leaf("视频",null,videoList));
 
  menuList.add(new Leaf("音乐",null,menuMap.get("music").get("其它")));
 
  menuList.add(new Leaf("新闻",null,newsList));
  menuList.add(new Leaf("博客",null,menuMap.get("blog").get("其它")));
  menuList.add(new Leaf("微博",null,menuMap.get("tt").get("其它")));
  menuList.add(new Leaf("购物",null,menuMap.get("shop").get("其它")));
  menuList.add(new Leaf("问问",null,menuMap.get("wenwen").get("其它")));
  menuList.add(new Leaf("小垂直",null,menuMap.get("xiaochuizhi").get("其它")));
  /****无线********/
  ArrayList<Leaf> wapList = new ArrayList<Leaf>();
  java.util.Iterator<?> wapClaIt = menuMap.get("wap").entrySet().iterator();
          //二级目录
   while(wapClaIt.hasNext()){
      java.util.Map.Entry<String,ArrayList<Leaf>> entry = (java.util.Map.Entry<String,ArrayList<Leaf>>)wapClaIt.next();
      wapList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }
  menuList.add(new Leaf("无线",null,wapList));
  
  ArrayList allList = new ArrayList();
  java.util.Iterator allClaIt = menuMap.get("all").entrySet().iterator();   
   while(allClaIt.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)allClaIt.next();
        allList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }   
  menuList.add(new Leaf("其它",null,allList));
  
  java.util.Iterator coopClaIt = menuMap.get("cooperation").entrySet().iterator();  
  ArrayList coopList = new ArrayList();
    //二级目录
   while(coopClaIt.hasNext()){
        java.util.Map.Entry entry = (java.util.Map.Entry)coopClaIt.next();
        coopList.add(new Leaf(entry.getKey().toString(),null,(ArrayList<Leaf>)entry.getValue()));
  }
  menuList.add(new Leaf("部门合作",null,coopList));
  
  
  menuList.add(new Leaf("申请管理",null,menuMap.get("apply").get("其它")));

/*********test************/
  ArrayList apolloList = new ArrayList();
  apolloList.add(new Leaf("基本信息","apollo/index.jsp?act=basic",null));
  apolloList.add(new Leaf("趋势查询","apollo/index.jsp?act=trend",null));
  apolloList.add(new Leaf("流量查询","apollo/index.jsp?act=flow",null));

  menuList.add(new Leaf("Apollo",null,apolloList));  
  
  /*************************/

  ArrayList flowList = new ArrayList(){{
  //add(new Leaf("普通请求","flow/index.jsp?table=umis_web_apache_common_stat",null));
  add(new Leaf("IP查询","flow/index.jsp?table=umis_web_apache_ip_stat",null));
  add(new Leaf("PID查询","flow/index.jsp?table=umis_web_apache_pid_stat",null));
  add(new Leaf("QUERY查询","flow/index.jsp?table=umis_web_apache_query_stat",null));
  //add(new Leaf("普通请求","flow/list.jsp?table=umis_web_apache_common_stat",null));
  //add(new Leaf("流量查询系统","flow/index.jsp?act=basic",null));
  //add(new Leaf("查询违禁词","secadmin_input.do?method=showRecordList",null));
  }};


  menuList.add(new Leaf("流量查询",null,flowList));  
 
  ArrayList uigsList = new ArrayList();
  uigsList.add(new Leaf("web","uigs/index.jsp?table=umis_web_uigs_minpvuv_stat",null));
  menuList.add(new Leaf("UIGS",null,uigsList));  
  
  
  Leaf root = new Leaf("",null,menuList);

  %>  
<HTML>
<HEAD>
<TITLE>UBS操作权限申请单</TITLE>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<STYLE type=text/css>
* {
    FONT-SIZE: 14px;
    FONT-FAMILY: "Palatino Linotype", "Tahoma", "Verdana", "Helvetica", "宋体"
}


.HideSpan {display:none}
@media Screen {
    BODY {
        BACKGROUND-IMAGE: url(background.gif)
    }
    #print {
        FONT-WEIGHT: bold;
        CURSOR: pointer;
        COLOR: red
    }
    .input_t {
        BORDER-RIGHT: 0px;
        BORDER-TOP: 0px;
        BORDER-LEFT: 0px;
        BORDER-BOTTOM: 1px solid;
        BACKGROUND-COLOR: transparent
    }
    .blkc {
        
    }
    .mainframe {
        
    }
}

</STYLE>
<SCRIPT type=text/javascript>
function $1(E) {
    return document.getElementById(E);
}
function trimnum(n) {
    n = (n<10)?("0"+n):n;
    return n;
}

function gettoday() {
    var d=new Date();
    with(d)
        r=getFullYear()+"-"+trimnum(getMonth()+1)+"-"+trimnum(getDate());
    return r;
}
var ids = new Array("name","dep","date","phone","uid","leader");
var msg = new Array("姓名","部门","日期","分机号","要分配权限的SOGOU-INC.COM或SOHU-INC.COM帐户名","直线leader的RD邮箱");
function refreshpage() {
    $("main").className = "mainframe";
    for(j=1;j<=8;j++) {
        $("blkc"+j).className = ($("c["+j+"]").checked)?"":"blkc";

        if(!$("c["+j+"]").checked) {
            for(i=0;i<2;i++) {
                $("c["+j+"]["+i+"]").checked = false;
                $("c["+j+"]["+i+"]").disabled = true;
            }
        } else {
            for(i=0;i<2;i++) {
                $("c["+j+"]["+i+"]").disabled = false;
            }
        }
    }
    
    
}

//三级联动
function Dsy()
{
  this.Items = {};
}
Dsy.prototype.add = function(id,iArray)
{
  this.Items[id] = iArray;
}
Dsy.prototype.Exists = function(id)
{
  if(typeof(this.Items[id]) == "undefined") return false;
  return true;
}
  
  function change(v){
      var str="0";
      for(i=0;i<v;i++){ str+=("_"+(document.getElementById(s[i]).selectedIndex-1));};
      var ss=document.getElementById(s[v]);
      with(ss){
          length = 0;
          options[0]=new Option(opt0[v],opt0[v]);
          if(v && document.getElementById(s[v-1]).selectedIndex>0 || !v)
          {
              if(dsy.Exists(str)){
                  ar = dsy.Items[str];
                  for(i=0;i<ar.length;i++){
                    var item = ar[i];
                    var option = new Option(item.name, item.name);
                    option.setAttribute && option.setAttribute("data-value", item.value);
                    options[length] = option;
                  }
                  if(v)options[0].selected = true;
              }
          }
          if(++v<s.length){change(v);}
      }
  }
  
  var dsy = new Dsy();
  
  var xx=new Array();
  var level1="0"
  <%for(int i=0;i<menuList.size();i++){
    Leaf leaf=(Leaf)menuList.get(i);
    String menuName=leaf.getNodeName();
    String menuValue = leaf.getNodeValue() !=null ? leaf.getNodeValue() : "";
    if(leaf.hasChild()){
        ArrayList list1=leaf.getChildList();
  %>
        var level2=level1+"_"+<%=i %>;
        var yy=new Array();
        <%
            for(int j=0;j<list1.size();j++){
                Leaf leaf1=(Leaf)list1.get(j);
                String menuName1=leaf1.getNodeName();
                String menuValue1 = leaf1.getNodeValue() !=null ? leaf1.getNodeValue() : "";
                if(leaf1.hasChild()){
                    ArrayList list2=leaf1.getChildList();           
        %>
                    var level3=level2+"_"+<%=j %>;
                    var zz=new Array();
                     <%
                    for(int k=0;k<list2.size();k++){
                        Leaf leaf2=(Leaf)list2.get(k);
                        String menuName2=leaf2.getNodeName();
                        String menuValue2 = leaf2.getNodeValue() !=null ? leaf2.getNodeValue() : "";
                    %>
                    zz.push({name: '<%=menuName2 %>', value: '<%=menuValue2 %>'});
                <%}%>
                dsy.add(level3,zz);
                <%}%>
        yy.push({ name: "<%=menuName1 %>", value: "<%=menuValue1 %>"});
        
        <%}%>
        dsy.add(level2,yy);
        
  <%}%>
  xx.push({name: "<%=menuName %>", value: "<%=menuValue %>" });
  <%}%>
  dsy.add(level1,xx);
  //dsy.add("0",["网页","图片","视频","音乐","新闻","博客","微博","其它","申请管理"]);
  
  /*
  dsy.add("0_0",["SPIDER黑名单","前台黑名单","Query黑名单","网页hint","网页VR","人工干预系统","其它"]);
  dsy.add("0_0_0",["域名表","前缀表","保护白名单"]);
  dsy.add("0_0_1",["限制词维护","限制词分类维护"]);
  dsy.add("0_0_2",["网页query维护","网页快照维护"]);
  dsy.add("0_0_3",["网页hint黑名单","网页hint白名单","网页hint彩蛋"]);
  dsy.add("0_0_4",["VR黑名单","VR白名单","VRINFO","VRSEED","外部VR数据审核","VR数据格式验证"]);
  dsy.add("0_0_5",["网页人工干预"]);
  dsy.add("0_0_6",["网页rerank白名单","网页qc不纠错","网页qc纠错为","网页suggestion黑名单"]);
  
  dsy.add("0_1",["resin前台黑名单","Tiny服务干预","人工干预","其它"]);
  dsy.add("0_1_0",["图片query黑名单","前台查询词黑名单","前台hint、hobby黑名单","前台detail页屏蔽黑名单","前台白名单"]);
  dsy.add("0_1_1",["图片hint黑名单","图片hint白名单","图片hobby黑名单","图片hint彩蛋","图片hobby彩蛋","图片qc就错为","图片qc不纠错"]);
  dsy.add("0_1_2",["预览模式","列表模式"]);
  dsy.add("0_1_3",["站点色情级别","抓取大站列表"]);

  dsy.add("0_2",["resin前台黑名单","Tiny服务干预","人工干预","其它"]);
  dsy.add("0_2_0",["图片query黑名单","前台查询词黑名单","前台hint、hobby黑名单","前台detail页屏蔽黑名单","前台白名单"]);
  dsy.add("0_2_1",["图片hint黑名单","图片hint白名单","图片hobby黑名单","图片hint彩蛋","图片hobby彩蛋","图片qc就错为","图片qc不纠错"]);
  dsy.add("0_2_2",["预览模式","列表模式"]);
  dsy.add("0_2_3",["站点色情级别","抓取大站列表"]);

  dsy.add("0_2",["resin前台黑名单","Tiny服务干预","人工干预","其它"]);
  dsy.add("0_2_0",["视频query黑名单","前台查询词黑名单","前台hint、hobby黑名单"]);
  dsy.add("0_2_1",["视频hint黑名单","视频hint白名单","视频hobby黑名单","视频hint彩蛋","视频hobby彩蛋","视频qc就错为","视频qc不纠错"]);
  dsy.add("0_2_2",["预览模式","列表模式"]);
  dsy.add("0_2_3",["视频XML路种子","抓取大站列表","视频localquery SiteRank","视频人工配hub种子","优质站点路种子"]);
  
  dsy.add("0_3",["其它"]);
  dsy.add("0_3_0",["音乐index黑名单"]);
  
  dsy.add("0_4",["其它"]);
  dsy.add("0_4_0",["新闻抓取seed","新闻数据制作黑名单","新闻query黑名单"]);

  dsy.add("0_5",["其它"]);
  dsy.add("0_5_0",["博客抓取seed","博客活跃站点"]);

  dsy.add("0_6",["其它"]);
  dsy.add("0_6_0",["微博url黑名单","微博博主黑名单"]);
  */
  
  var s=["product","module","item"];
  var opt0 = ["产品","模块","项目"];
  function setup()
  {
  for(i=0;i<s.length-1;i++)
   document.getElementById(s[i]).onchange=new Function("change("+(i+1)+")");
  change(0);
  }

 
  var liNo = 0;
  function removePri(liId){
    var priUl = document.getElementById("priUl");
    var li =  document.getElementById(liId);
    priUl.removeChild(li);
        
  }

 
  function addPri(){
    var pro = document.getElementById("product").value;
    var module = document.getElementById("module").value;
    var item = document.getElementById("item").value;
    var role = document.getElementById("role").value;

    var dataValue = getDataValue();
    
    var priUl = document.getElementById("priUl");//.innerHTML = pro+"-"+module+"-"+item+"("+role+")";
    var li=document.createElement("LI");
    li.id = "pri_"+(liNo++);
    //li.name = "priLi";
    li.setAttribute("name","priLi");
    li.innerHTML = pro+"-"+module+"-"+item+"("+role+")&nbsp;&nbsp;<a title=删除 href=\"javascript:void(0)\"  onclick=\"removePri('"+li.id+"')\">x</a>" + (dataValue ? ("<br /><span>table&nbsp;:&nbsp;" + dataValue + "</span>") : "") ;
    priUl.appendChild(li);
  }

  function getDataValue(){
    for(var i=0; i<s.length; i++){
        var item = document.getElementById(s[i]), reg = /table=([^&$]*)/gi;
        if(item){
            var jtem = item.options[item.selectedIndex];
            var value = jtem.getAttribute("data-value");
            if(value){
                var arr = reg.exec(value);
                if(arr){
                    return arr[1];
                }
            }
        }
    }
    return "";
  }

</SCRIPT>
<script language="JavaScript" src="js/jquery.js?v=20100412"></script>
<META content="MSHTML 6.00.6000.16850" name=GENERATOR>
</HEAD>
<BODY onload=refreshpage()>
<TABLE align=center>
    <TBODY>
        <TR>
            <TD align=middle><B>用户权限申请（变更、注销）表</B></TD>
        </TR>
        <TR>
            <TD align=right>――UMIS操作权限</TD>
        </TR>
    </TBODY>
</TABLE>
<BR>
<BR>
<TABLE width=600 align=center>
    <TBODY>
        <TR>
            <TD>编号：<U>NO-UMIS-2010</U></TD>
            <TD align=right>&nbsp;<A id=print onclick="javascript:printme()"><span>邮件发送</SPAN></A></TD>
        </TR>
    </TBODY>
</TABLE>
<SPAN id=main>
<form action="apply.do?method=send" method="POST" name="applyForm" id="applyForm"> 
<TABLE class=maintable width=600 align=center border=2 style="  FONT-SIZE: 14px;FONT-FAMILY: 'Palatino Linotype', 'Tahoma', 'Verdana', 'Helvetica','宋体';BORDER-RIGHT: #000000 1px solid;    BORDER-TOP: #000000 1px solid;  BORDER-LEFT: #000000 1px solid; BORDER-BOTTOM: #000000 1px solid;   BORDER-COLLAPSE: collapse">
    <TBODY>
        <TR style="HEIGHT: 40px">
            <TD align=middle>申请人姓名</TD>
            <TD>&nbsp;<INPUT class=input_t id=name size=10 name=name value=""><span id="sname" class="HideSpan"></span></TD>
            <TD align=middle>申请人部门</TD>
            <TD>&nbsp;<INPUT class=input_t id=dep size=12 name=dep value=""><span id="sdep"  class="HideSpan"></span></TD>
            <TD align=middle>申请日期</TD>
            <TD>&nbsp;<INPUT class=input_t id=date size=9 name=date value=""><span id="sdate"  class="HideSpan"></span></TD>
        </TR>
        <TR style="HEIGHT: 40px">
            <TD align=middle>申请人分机</TD>
            <TD>&nbsp;<INPUT class=input_t id=phone size=10 name=phone value=""><span id="sphone"  class="HideSpan"></span></TD>
            <TD align=middle>Leader 邮箱</TD>
            <TD colSpan=3>&nbsp;<INPUT class=input_t id=leader size=30 name=leader value=""><span id="sleader"  class="HideSpan"></span></TD>
        </TR>
        <TR style="HEIGHT: 40px">
            <TD align=middle>操作类型</TD>
            <TD colSpan=5>
                <INPUT type=radio CHECKED name=type value="申请用户">申请用户 
                <INPUT type=radio name=type value="用户权限变更">用户权限变更 
                <INPUT type=radio name=type value="注销用户">注销用户
            </TD>
        </TR>
        <TR style="HEIGHT: 40px">
            <TD align=middle>系统名称</TD>
            <TD colSpan=5>统一干预信息管理系统UMIS</TD>
        </TR>
        <TR style="HEIGHT: 60px">
            <TD align=middle>分配(变更,<BR>
            注销)的<BR>
            用户ID</TD>
            <TD vAlign=top colSpan=5>(使用sogou-inc.com或sohu-inc.com域帐户名(<FONT color=red>必须</FONT>)):<BR>
            <BR>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <INPUT class=input_t id=uid size=30 name=uid  value=""><span id="suid"  class="HideSpan"></span></TD>
        </TR>
        
        <TR style="HEIGHT: 300px">
            <TD align=middle>权限项目</TD>
            <TD vAlign=top colSpan=5>
            
            <div id=priSel>
            <select id="product" NAME="product" style="width:60"></select>
            <select id="module" NAME="module"></select>
            <select id="item" NAME="item"></select>
        
            <SCRIPT language="javascript">    
            //初始化省市三级菜单    
             setup()      
            </SCRIPT>   
 
            <select id="role" NAME="role">
                <option value="普通管理员" selected=true>普通管理员</option>
                <option value="超级管理员">超级管理员</option>
            </select>
            <input type="button" name="addBtn" value="添加" onclick="addPri();">
            <BR>
            </div>
            <ul id="priUl">
            </ul>
            
            </TD>   
        </TR>
        <TR style="HEIGHT: 40px">
            <TD align=middle>权限<BR>含义<BR>说明</TD>
            <TD colSpan=5>1.【超级管理员】单独增删改查、批量增删改、上线<br>
            2.【普通管理员】单独增删改查、上线
            </TD>
        </TR>
    </TBODY>
</TABLE>
</form>
</SPAN>
</BODY>
<SCRIPT type=text/javascript>
$1("date").value = gettoday();
function printme() {

    for(i=0;i<ids.length;i++) {
        if($1(ids[i]).value=="") {
            alert("请输入"+msg[i]+"!");
            $1(ids[i]).focus();
            return false;
        }else
            $1("s"+ids[i]).innerHTML = $1(ids[i]).value;
    }
    
    var priLis=$("li[name='priLi']");
    if(priLis.length == 0)
        alert("请选择/输入权限说明！");
    else{
        for(var i = 0;i < priLis.length;i++){
            if(priLis[i].innerHTML.indexOf("产品")!=-1||priLis[i].innerHTML.indexOf("模块")!=-1){
               alert("请选择有效的权限！");
               return;
            }
        }
    
    }

    if($1("product").value=="产品" || $1("module").value =="模块")
        alert("请选择/输入权限说明！");

    var html = encodeURIComponent(document.body.innerHTML);
    //html  = encodeURIComponent(html);
    var url = "apply.do?method=send";
    $.ajax({type:'post',async:true,'url':url,data:{'html':html,'leader':$1("leader").value,'uid':$1("uid").value}, success:function(data){
        if(data != 'ok') {
            //$1("#popMsg").html("<div style='color:red;margin:10px;font-weight:bold;'>删除失败!</div>"+
            //"<div style='font-size:0.9em;margin:10px;'>"+data+"</div>");
            alert("发送失败！");
        } else {
        
            alert("发送成功！");
            //$1("#popMsg").html("<div style='margin:10px;'>资源删除成功!</div>");
            //function timeout(){window.location.reload();}
            //setTimeout(timeout, 2000);
        }
    }});
}
</SCRIPT>
</HTML>
<!--zly-->
